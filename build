export CLASSPATH=./classes:$CLASSPATH 
DIST=./classes
VERSION=0.2.1

echo "PILOTS Build Script v0.2"
echo "Please make sure the current directory is in your CLASSPATH"
echo ""

if [ -d $DIST ]; then
		rm -rf $DIST
fi
echo "Making dir: "$DIST
mkdir $DIST

echo "package pilots;" > ./pilots/Version.java
echo "public class Version { public static final String ver = \"$VERSION\"; }" >> ./pilots/Version.java

echo "Compiling pilots/"
javac -Xlint:none -d $DIST pilots/Version.java

echo "Compiling pilots/compiler"
javac -Xlint:none -d $DIST `find pilots/compiler/ | grep "java$"`

echo "Compiling pilots/runtime"
javac -Xlint:none -d $DIST `find pilots/runtime/ | grep "java$"`

echo "Compiling pilots/util"
javac -Xlint:none -g -d $DIST `find pilots/util/ | grep "java$"`

echo "Generating jar file..."
cd $DIST
jar cf ../lib/pilots.jar `find pilots/compiler/` `find pilots/runtime/` `find pilots/util/`
cd ..

echo "Finished!"

